<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ficha RPG PokÃ©mon: VersÃ£o Oficial</title>
  <meta name="theme-color" content="#0D1117">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
  <div id="app">
    <header class="header">
      <div class="header-top">
        <input type="text" id="nome" placeholder="Nome do Treinador" />
        <div class="nivel-info">
          <label>Nv.</label>
          <input type="number" id="nivel" min="1" value="1" />
          <span class="badge" data-tip="BÃ´nus Prof">PROF <span id="prof">+2</span></span>
          <span class="badge">MAX SR <span id="max_sr">2</span></span>
          <span class="badge">SLOTS <span id="slots">3</span></span>
        </div>
      </div>
      <div class="header-actions">
        <label class="theme-selector-wrap">
          <span class="theme-label">Tema</span>
          <select id="theme-select" title="Escolha um tema PokÃ©mon">
            <option value="bulbasaur">ğŸŒ¿ Bulbasaur</option>
            <option value="pikachu">âš¡ Pikachu</option>
            <option value="charmander">ğŸ”¥ Charmander</option>
            <option value="squirtle">ğŸ’§ Squirtle</option>
            <option value="gastly">ğŸ‘» Gastly</option>
            <option value="mew">âœ¨ Mew</option>
            <option value="umbreon">ğŸŒ™ Umbreon</option>
            <option value="gengar">ğŸ˜ˆ Gengar</option>
            <option value="pokebola">ğŸ”´ PokÃ©bola</option>
          </select>
        </label>
        <div class="export-import">
          <a href="/mestre" class="btn-mestre" title="Abrir painel do Mestre">ğŸ® Mestre</a>
          <button type="button" id="btn-sessao" title="Entrar em sessÃ£o do Mestre">ğŸ“¡ SessÃ£o</button>
          <button type="button" id="btn-export" title="Exportar ficha como JSON">ğŸ“¤ Exportar</button>
          <button type="button" id="btn-import" title="Importar ficha (compatÃ­vel com versÃ£o Flet)">ğŸ“¥ Importar</button>
          <input type="file" id="input-import" accept=".json" hidden />
        </div>
      </div>
    </header>

    <div id="modal-sessao" class="modal hidden">
      <div class="modal-content modal-sessao">
        <h3>ğŸ“¡ Entrar em SessÃ£o</h3>
        <p class="desc">Digite o cÃ³digo que o Mestre forneceu. Suas rolagens serÃ£o visÃ­veis para ele.</p>
        <label>CÃ³digo</label>
        <input type="text" id="sessao-codigo" placeholder="Ex: ABC123" maxlength="10" />
        <label>Seu nome (Treinador)</label>
        <input type="text" id="sessao-jogador" placeholder="Nome do Treinador" />
        <div class="modal-actions">
          <button type="button" id="sessao-sair" class="btn-secondary hidden">Sair da SessÃ£o</button>
          <button type="button" id="sessao-entrar" class="primary">Entrar</button>
        </div>
      </div>
    </div>

    <nav class="nav-tabs">
      <button class="tab active" data-tab="treinador">ğŸ… Treinador</button>
      <button class="tab" data-tab="pericias">ğŸ¯ PerÃ­cias</button>
      <button class="tab" data-tab="mochila">ğŸ’ Mochila</button>
      <button class="tab" data-tab="equipe">ğŸ¾ Equipe</button>
      <button class="tab" data-tab="regras">ğŸ“– Regras</button>
    </nav>

    <main class="content">
      <section id="panel-treinador" class="panel active">
        <div class="card-group">
          <div class="card">
            <h3>ğŸŒ RegiÃ£o de Origem</h3>
            <select id="regiao"></select>
            <p id="regiao-desc" class="desc"></p>
            <p id="regiao-hab" class="hab"></p>
          </div>
          <div class="card">
            <h3>ğŸ“œ Origem de Jornada</h3>
            <select id="origem_jornada"></select>
            <p id="origem-desc" class="desc"></p>
            <p id="origem-hab" class="hab"></p>
            <p id="origem-equip" class="equip"></p>
            <div id="container-tm" class="hidden">
              <label>TM (Estudioso)</label>
              <select id="tm"></select>
            </div>
          </div>
          <div class="card">
            <h3>â­ EspecializaÃ§Ã£o</h3>
            <label>1Âª (Nv 1)</label>
            <select id="especializacao"></select>
            <div id="container-espec-2" class="espec-extra hidden">
              <label>2Âª (Nv 7+)</label>
              <select id="especializacao_2"></select>
            </div>
            <div id="container-espec-3" class="espec-extra hidden">
              <label>3Âª (Nv 18+)</label>
              <select id="especializacao_3"></select>
            </div>
            <p id="espec-desc" class="desc"></p>
            <div id="container-espec-pericia" class="hidden">
              <label>Escolha a perÃ­cia</label>
              <select id="espec_pericia"></select>
            </div>
            <div id="container-espec-atributo" class="hidden">
              <label>Atributo +1</label>
              <select id="espec_atributo"></select>
            </div>
          </div>
          <div class="card">
            <h3>ğŸ“ Classe (Nv.2+)</h3>
            <select id="classe"></select>
            <p id="classe-desc" class="desc"></p>
            <div id="classe-hab" class="hab classe-habilidades"></div>
          </div>
        </div>

          <div class="card combate">
          <h3>âš¡ Combate</h3>
          <div class="combate-grid">
            <div class="stat-box">
              <span>CA</span>
              <strong id="ca">10</strong>
            </div>
            <div class="stat-box">
              <span>INIC.</span>
              <strong id="inic">+0</strong>
              <button type="button" class="btn-roll" id="roll-inic" title="Rolar iniciativa">ğŸ²</button>
            </div>
            <div class="stat-box">
              <span>DESL.</span>
              <input type="text" id="deslocamento" value="9m" />
            </div>
          </div>
          <p id="resultado-inic" class="resultado"></p>
          <div class="hp-manager">
            <div class="hp-row">
              <div class="hp-label-wrap">
                <span class="hp-icon">â¤ï¸</span>
                <span class="hp-title">PV</span>
              </div>
              <div class="hp-values">
                <input type="text" id="hp_atual" class="hp-input-current" />
                <span class="hp-sep">/</span>
                <input type="number" id="hp_max" class="hp-input-max" />
              </div>
              <div class="hp-buttons">
                <button type="button" class="btn-sm btn-hp" id="hp-minus" title="âˆ’1 PV">âˆ’</button>
                <button type="button" class="btn-sm btn-hp" id="hp-plus" title="+1 PV">+</button>
              </div>
            </div>
            <div class="hp-bar-wrap">
              <div class="hp-bar"><div id="hp-bar-fill" class="hp-fill"></div></div>
              <span id="hp-sug" class="hp-sug"></span>
            </div>
          </div>
          <div class="saves">
            <h4>ğŸ›¡ï¸ Testes de ResistÃªncia</h4>
            <div id="saves-grid"></div>
            <p id="resultado-save" class="resultado"></p>
          </div>
          <div class="roller">
            <h4>ğŸ² Roller</h4>
            <select id="roller-dado"><option value="d20">d20</option><option value="d12">d12</option><option value="d10">d10</option><option value="d8">d8</option><option value="d6">d6</option><option value="d4">d4</option></select>
            <span>+</span>
            <input type="number" id="roller-mod" value="0" placeholder="Mod" />
            <button type="button" class="btn-roll" id="roller-btn">Rolar</button>
            <span id="roller-result"></span>
          </div>
          <div class="historico">
            <h4>ğŸ“œ HistÃ³rico</h4>
            <div id="historico-list"></div>
          </div>
        </div>

        <div class="card atributos">
          <h3>ğŸ’ª Atributos</h3>
          <div id="point-buy-status"></div>
          <div id="atributos-grid"></div>
        </div>

        <div class="card talentos-card">
          <h3>âœ¨ Talentos</h3>
          <div class="talentos-add-row">
            <select id="talento-select"></select>
            <button type="button" id="talento-add-btn">+ Adicionar</button>
          </div>
          <div id="talentos-selected" class="talentos-chips"></div>
          <div id="talentos-desc" class="desc talentos-desc"></div>
        </div>
      </section>

      <section id="panel-pericias" class="panel">
        <div class="card">
          <h3>ğŸ¯ PerÃ­cias</h3>
          <p id="pericias-auto" class="auto"></p>
          <p id="resultado-pericia" class="resultado"></p>
          <div id="pericias-grid"></div>
        </div>
      </section>

      <section id="panel-mochila" class="panel panel-mochila">
        <div class="mochila-grid">
        <div class="card">
          <h3>ğŸ’° PokÃ©dollars</h3>
          <input type="text" id="pokedollars" />
          <button type="button" id="roll-dinheiro">ğŸ² Rolar Dinheiro Inicial</button>
          <p id="resultado-dinheiro" class="resultado"></p>
        </div>
        <div class="card">
          <h3>ğŸ’ Mochila</h3>
          <label>PokÃ©bolas</label>
          <input type="text" id="pokebolas" />
          <label>Itens Chave</label>
          <textarea id="itens_chave" rows="3"></textarea>
          <label>ConsumÃ­veis</label>
          <textarea id="consumiveis" rows="2"></textarea>
          <label>Pacote de Aventura</label>
          <select id="pacote_aventura"></select>
          <p id="pacote-desc" class="desc"></p>
        </div>
        </div>
      </section>

      <section id="panel-equipe" class="panel">
        <div class="card equipe-card">
          <div class="equipe-header">
            <h3>âš”ï¸ Equipe PokÃ©mon</h3>
            <span class="equipe-slots" id="equipe-slots">0/6</span>
          </div>
          <div class="add-poke-wrap">
            <div class="add-poke">
              <div class="pokedex-search-wrap">
                <input type="text" id="novo-poke-nome" placeholder="Buscar no PokÃ©dex (ex: Pikachu, Charmander)" autocomplete="off" />
                <ul id="pokedex-suggestions" class="pokedex-suggestions hidden"></ul>
              </div>
              <button type="button" id="add-poke" class="btn-add-poke">+ Adicionar</button>
            </div>
            <p class="add-poke-hint">Digite o nome e selecione da lista, ou use "Adicionar" para PokÃ©mon personalizado.</p>
          </div>
          <div id="lista-pokemons-empty" class="lista-pokemons-empty hidden">
            <p>Nenhum PokÃ©mon na equipe.</p>
            <p class="empty-hint">Busque pelo nome no PokÃ©dex acima ou adicione manualmente.</p>
          </div>
          <div id="lista-pokemons" class="lista-pokemons"></div>
        </div>
      </section>

      <section id="panel-regras" class="panel">
        <div class="card regras-search-card">
          <div class="regras-search-row">
            <input type="search" id="regras-search" placeholder="Ex: captura, pescaria, lealdade..." autocomplete="off" />
            <div class="regras-search-nav hidden" id="regras-search-nav">
              <span id="regras-search-count"></span>
              <button type="button" id="regras-search-prev" title="Anterior">â†</button>
              <button type="button" id="regras-search-next" title="PrÃ³ximo">â†’</button>
            </div>
          </div>
        </div>
        <div class="card calc-captura">
          <h3>ğŸ¯ Calculadora de Captura</h3>
          <p class="desc">CD = 10 + SR base (arred. â†“) + nÃ­vel + vida restante Ã· 10 (arred. â†“). A PokÃ©bola adiciona bÃ´nus Ã  <em>rolagem</em>.</p>
          <div class="calc-captura-grid">
            <label>NÃ­vel do PokÃ©mon</label>
            <input type="number" id="calc-nivel" min="1" max="20" value="3" placeholder="1â€“20" />
            <label>SR</label>
            <select id="calc-sr">
              <option value="0.125">1/8</option>
              <option value="0.25">1/4</option>
              <option value="0.5" selected>1/2</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
              <option value="13">13</option>
              <option value="14">14</option>
              <option value="15">15</option>
            </select>
            <label>HP Atual (vida restante)</label>
            <input type="number" id="calc-hp-atual" min="0" value="15" placeholder="Ex: 15" />
            <label>PokÃ©bola (bÃ´nus na rolagem)</label>
            <select id="calc-pokebola">
              <option value="0">PokÃ©bola (+0)</option>
              <option value="5">Great Ball (+5)</option>
              <option value="10">Ultra Ball (+10)</option>
              <option value="10" data-cond="nÃ­veis">Level Ball (+10 a +30)</option>
              <option value="15" data-cond="inseto-agua">Net Ball (+15 vs Inseto/Ãgua)</option>
              <option value="15" data-cond="nv5">Nest Ball (+15 vs Nv â‰¤5)</option>
              <option value="15" data-cond="repetida">Repeat Ball (+15 vs espÃ©cie capturada)</option>
              <option value="5">Luxury Ball (+5, Lealdade +1)</option>
              <option value="15" data-cond="agua">Dive Ball (+15 vs na Ã¡gua)</option>
              <option value="15" data-cond="noite">Dusk Ball (+15 Ã  noite/escuro)</option>
              <option value="20" data-cond="moon">Moon Ball (+20 vs Moon Stone)</option>
              <option value="5">Heal Ball (+5, cura apÃ³s captura)</option>
              <option value="2" data-cond="rodadas">Timer Ball (+2/rodada, mÃ¡x +20)</option>
              <option value="5">Premier Ball (+5, CAR +2)</option>
              <option value="20" data-cond="1rodada">Quick Ball (+20 sÃ³ 1Âª rodada)</option>
              <option value="20" data-cond="pescado">Lure Ball (+20 vs pescado)</option>
              <option value="30" data-cond="love">Love Ball (+30 vs mesmo sp. gÃªnero oposto)</option>
              <option value="5" data-cond="tamanho">Heavy Ball (+5 a +20)</option>
              <option value="20" data-cond="ultra">Beast Ball (+20 vs Ultra Beast)</option>
              <option value="999">Master Ball (automÃ¡tico)</option>
            </select>
          </div>
          <div class="calc-captura-results">
            <div class="calc-captura-result" id="calc-captura-result">
              <span class="calc-cd-label">CD da Captura:</span>
              <strong class="calc-cd-val" id="calc-cd-val">â€”</strong>
            </div>
            <div class="calc-captura-result calc-bonus" id="calc-bonus-result">
              <span class="calc-cd-label">BÃ´nus na rolagem:</span>
              <strong class="calc-cd-val calc-bonus-val" id="calc-bonus-val">â€”</strong>
            </div>
          </div>
          <p class="calc-vantagem" id="calc-vantagem-dica">ğŸ’¡ Vantagem se: envenenado, queimando, paralisado, congelado, dormindo, confuso ou impedido. Rolagem = d20 + mod Adestrar Animais + prof + bÃ´nus PokÃ©bola.</p>
        </div>
        <div class="card resumo">
          <h3>ğŸ“‹ Resumo de Combate</h3>
          <div id="regras-resumo" class="markdown"></div>
        </div>
        <div class="card regras-full">
          <h3>ğŸ“– Guia Completo</h3>
          <div id="regras-texto" class="markdown"></div>
        </div>
      </section>
    </main>
  </div>

  <div id="modal-editar-poke" class="modal hidden">
    <div class="modal-content modal-editar-poke">
      <h3>âœï¸ Editar PokÃ©mon</h3>
      <div class="edit-poke-grid">
        <div>
          <label>Nome</label>
          <input type="text" id="edit-poke-nome" />
        </div>
        <div>
          <label>NÃ­vel</label>
          <input type="number" id="edit-poke-nivel" min="1" max="20" />
        </div>
        <div>
          <label>SR</label>
          <select id="edit-poke-sr"></select>
        </div>
        <div>
          <label>AC</label>
          <input type="number" id="edit-poke-ac" min="1" max="30" placeholder="Classe de armadura" />
        </div>
        <div>
          <label>HP MÃ¡x</label>
          <input type="number" id="edit-poke-hp_max" min="1" />
        </div>
        <div>
          <label>Tipo primÃ¡rio</label>
          <select id="edit-poke-tipo"></select>
        </div>
        <div>
          <label>Tipo secundÃ¡rio</label>
          <select id="edit-poke-tipo2"></select>
        </div>
        <div>
          <label>Natureza</label>
          <select id="edit-poke-natureza"></select>
        </div>
        <div>
          <label>Lealdade</label>
          <select id="edit-poke-lealdade"></select>
        </div>
      </div>
      <label>Habilidade especial</label>
      <div class="habilidade-row">
        <textarea id="edit-poke-habilidade" rows="2" placeholder="Ex: EstÃ¡tico, IntimidaÃ§Ã£o..."></textarea>
        <div id="edit-poke-habilidades-pokedex" class="pokedex-suggest-abilities hidden"></div>
      </div>
      <div id="edit-poke-moves-wrap" class="edit-poke-moves hidden">
        <label>Movimentos (PokÃ©dex)</label>
        <div id="edit-poke-moves" class="moves-pokedex"></div>
      </div>
      <div class="modal-actions">
        <button type="button" id="edit-poke-cancel">Cancelar</button>
        <button type="button" id="edit-poke-save" class="primary">Salvar</button>
      </div>
    </div>
  </div>

  <div id="roll-overlay" class="roll-overlay roll-overlay-hidden" aria-hidden="true">
    <div class="roll-pokeball-wrap">
      <div class="roll-pokeball">
        <div class="roll-pokeball-top"></div>
        <div class="roll-pokeball-band"></div>
        <div class="roll-pokeball-bottom"></div>
        <div class="roll-pokeball-center">
          <span class="roll-result-num">?</span>
        </div>
      </div>
      <p class="roll-result-msg"></p>
    </div>
  </div>

  <div id="toast" class="toast hidden"></div>

  <script src="/static/js/app.js"></script>
</body>
</html>
